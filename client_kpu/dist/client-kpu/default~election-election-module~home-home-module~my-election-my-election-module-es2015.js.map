{"version":3,"sources":["./src/app/_shared/components/modal-election-detail/modal-election-detail.component.html","./src/app/_shared/components/modal-election-detail/modal-election-detail.component.css","./src/app/_shared/components/modal-election-detail/modal-election-detail.component.ts","./src/app/_shared/components/modal-election-detail/modal-election-detail.module.ts","./src/app/_shared/services/election.service.ts"],"names":[],"mappings":"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","file":"default~election-election-module~home-home-module~my-election-my-election-module-es2015.js","sourcesContent":["export default \"<div *ngIf=\\\"isModalOpen\\\" [config]=\\\"{ show: true }\\\" bsModal #modalElectionDetail=\\\"bs-modal\\\" (onHidden)=\\\"onHidden()\\\"\\n  class=\\\"modal fade\\\" tabindex=\\\"-1\\\" role=\\\"dialog\\\" aria-labelledby=\\\"dialog-auto-name\\\">\\n  <div class=\\\"modal-dialog modal-dialog-centered modal-lg\\\">\\n    <div class=\\\"modal-content\\\">\\n      <div class=\\\"modal-header modal-header\\\" [ngStyle]=\\\"{\\n        'background-image': 'url(' + election.electionImage + ')',\\n        'background-size': 'cover',\\n        'background-position': 'center center'\\n      }\\\">\\n        <h1> &nbsp; <br /> &nbsp; </h1>\\n        <button type=\\\"button\\\" class=\\\"close pull-right\\\" aria-label=\\\"close\\\" (click)=\\\"hideModal()\\\">\\n          <span aria-hidden=\\\"true\\\">&times;</span>\\n        </button>\\n      </div>\\n      <div class=\\\"modal-body\\\">\\n        <div class=\\\"container-fluid\\\">\\n          <div class=\\\"row mb-3\\\">\\n            <h3 class=\\\"w-100 text-center pointer text-primary\\\">\\n              <a routerLink=\\\"/election/{{ election.id }}\\\" class=\\\"text-decoration-none pointer\\\">\\n                {{ election.electionName }}\\n              </a>\\n            </h3>\\n            <h5 class=\\\"text-muted w-100 text-center\\\">\\n              {{ election.electionDescription }}\\n            </h5>\\n          </div>\\n          <div class=\\\"row mb-3\\\">\\n            <div class=\\\"col my-auto p-0\\\">\\n              <div class=\\\"mb-3 col-12 text-center\\\">\\n                <ul class=\\\"list-unstyled row\\\" style=\\\"max-height: 25vh; overflow-y: auto;\\\">\\n                  <li class=\\\"media border-bottom mb-1 p-1 list-group-item-action col-md-6 col-lg-4\\\" *ngFor=\\\"let i of candidateListInfo\\\">\\n                    <img class=\\\"align-self-center mr-3\\\" src=\\\"{{ i.image }}\\\" height=\\\"64px\\\" />\\n                    <div class=\\\"media-body text-truncate text-left\\\">\\n                      <div class=\\\"m-0 pt-2\\\">\\n                        <a routerLink=\\\"/user/{{ i.pubKey }}\\\" style=\\\"cursor: pointer;\\\">{{ i.name }}</a>\\n                      </div>\\n                      <small class=\\\"pb-2\\\">{{ i.email }}</small>\\n                    </div>\\n                  </li>\\n                </ul>\\n              </div>\\n              <div class=\\\"col-12 text-center\\\" *ngIf=\\\"!this.as.currentUserValue\\\">\\n                <button type=\\\"button\\\" class=\\\"btn btn-sm btn-outline-danger\\\" routerLink=\\\"/login\\\">\\n                  Harap Masuk / Daftar Untuk Ikut Serta\\n                </button>\\n              </div>\\n              <div class=\\\"col-12 text-center\\\" *ngIf=\\\"this.as.currentUserValue\\\">\\n                <div *ngIf=\\\"this.as.currentUserValue.role == 'voter' && election.electionCreator != this.as.currentUserValue.pubKey\\\">\\n                  <div *ngIf=\\\"election.electionIsActive == 1\\\">\\n                    <button type=\\\"button\\\" *ngIf=\\\"joined == null\\\"\\n                      class=\\\"btn btn-sm btn-outline-primary\\\" (click)=\\\"confirmjoinElection()\\\">\\n                        Daftar Sebagai Partisipan Pemilih\\n                    </button>\\n                    <p *ngIf=\\\"joined == 0\\\">\\n                      Pendaftaran Sebagai Partisipan Telah Dikirimkan Dan Menunggu Konfirmasi Pemilik\\n                    </p>\\n                  </div>\\n                  <button type=\\\"button\\\" class=\\\"btn btn-sm btn-outline-primary\\\"\\n                    *ngIf=\\\"joined == 1 || election.electionIsActive == 0\\\" routerLink=\\\"/election/{{ election.id }}\\\" >\\n                    Menuju Halaman Detail Pemilihan\\n                  </button>\\n                </div>\\n              </div>\\n            </div>\\n          </div>\\n        </div>\\n        <div class=\\\"col-12\\\">\\n          <div class=\\\"row\\\">\\n            <small class=\\\"col-6 text-left text-muted mt-auto\\\">{{ election.electionId }}</small>\\n            <small class=\\\"col-6 text-right text-muted\\\" *ngIf=\\\"this.as.currentUserValue\\\">\\n              <a routerLink=\\\"/my-election\\\" class=\\\"text-danger\\\"\\n                *ngIf=\\\"election.electionCreator == this.as.currentUserValue.pubKey && !router.url.includes('/election/')\\\">\\n                  You're The Owner, Manage This Election\\n                  <i class=\\\"fa fa-fw fa-arrow-right\\\"></i>\\n              </a>\\n            </small>\\n          </div>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\\n<app-confirm-modal (submitButton)=\\\"confirmModalCallback($event)\\\"></app-confirm-modal>\"","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL19zaGFyZWQvY29tcG9uZW50cy9tb2RhbC1lbGVjdGlvbi1kZXRhaWwvbW9kYWwtZWxlY3Rpb24tZGV0YWlsLmNvbXBvbmVudC5jc3MifQ== */\"","import { Component, OnInit, ViewChild } from '@angular/core';\n\nimport { ModalDirective } from 'ngx-bootstrap';\n\nimport { GlobalService } from '../../services/global.service';\n\nimport { Election } from '../../models/election';\nimport { AuthService } from '../../services/auth.service';\nimport { Router } from '@angular/router';\nimport { ApiService } from '../../services/api.service';\nimport { ElectionService } from '../../services/election.service';\nimport { ConfirmModalComponent } from '../confirm-modal/confirm-modal.component';\n\n@Component({\n  selector: 'app-modal-election-detail',\n  templateUrl: './modal-election-detail.component.html',\n  styleUrls: ['./modal-election-detail.component.css']\n})\nexport class ModalElectionDetailComponent implements OnInit {\n\n  @ViewChild('modalElectionDetail', { static: false }) modalElectionDetail: ModalDirective;\n  @ViewChild(ConfirmModalComponent, { static: true }) confirmModal: ConfirmModalComponent;\n\n  election: Election = null;\n  isModalOpen = false;\n\n  currentUser = null;\n\n  candidateListInfo = [];\n\n  joined = null;\n\n  constructor(\n    public router: Router,\n    private gs: GlobalService,\n    public as: AuthService,\n    private es: ElectionService\n  ) { }\n\n  ngOnInit() {\n    this.as.currentUser.subscribe(user => {\n      this.currentUser = user;\n    });\n  }\n\n  hideModal() {\n    this.modalElectionDetail.hide();\n  }\n\n  onHidden() {\n    this.isModalOpen = false;\n  }\n\n  showModal(e: Election) {\n    this.gs.log('[COMPONENT_MODAL-ELECTION]', e);\n    this.election = e;\n    this.isModalOpen = true;\n    this.findElectionInJoined();\n    this.es.getElectionCandidate(e.id).subscribe(\n      res => {\n        this.gs.log('[ElectionCandidate]', res);\n        this.candidateListInfo = res.result.candidatesInfo;\n      }\n    );\n  }\n\n  findElectionInJoined() {\n    if (this.currentUser) {\n      this.es.loadMyJoinedElection().subscribe(\n        res => {\n          this.gs.log('[MyJoinedElection]', res);\n          const myJoinedElection = res.results;\n          const joinedElection = myJoinedElection.find(mJE => mJE.id === this.election.id);\n          if (joinedElection) {\n            this.joined = joinedElection.joined;\n          }\n        }\n      );\n    }\n  }\n\n  confirmjoinElection() {\n    this.confirmModal.showModal({\n      callbackData: 'joinElectionConfirmation',\n      title: `Gabung '${this.election.electionName}'`,\n      body: 'Apakah Yakin Ingin Bergabung Sebagai Partisipan?',\n      submit: 'Ya'\n    });\n  }\n\n  joinElection() {\n    this.es.joinElection(this.election.id).subscribe(\n      res => {\n        this.openModalMessage(res);\n      },\n      err => {\n        this.openModalMessage(err.error);\n      }\n    );\n  }\n\n  openModalMessage(res) {\n    this.gs.log('[JoinElection]', res);\n    this.hideModal();\n    this.confirmModal.showModal({\n      callbackData: 'joinElectionFinished',\n      title: `Gabung '${this.election.electionName}'`,\n      body: JSON.stringify(res.result.message),\n      submit: 'OK'\n    });\n  }\n\n  confirmModalCallback(callbackData) {\n    if (callbackData === 'joinElectionConfirmation') {\n      this.joinElection();\n    } else if (callbackData === 'joinElectionFinished') {\n      this.router.navigateByUrl(`/election/${this.election.id}`);\n    }\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\n\nimport { ModalModule, ButtonsModule } from 'ngx-bootstrap';\n\nimport { ModalElectionDetailComponent } from './modal-election-detail.component';\nimport { ConfirmModalModule } from '../confirm-modal/confirm-modal.module';\n\n@NgModule({\n  declarations: [ModalElectionDetailComponent],\n  imports: [\n    CommonModule,\n    RouterModule,\n    ModalModule.forRoot(),\n    ButtonsModule.forRoot(),\n    ConfirmModalModule\n  ],\n  exports: [ModalElectionDetailComponent]\n})\nexport class ModalElectionDetailModule { }\n","import { Injectable } from '@angular/core';\n\nimport { GlobalService } from './global.service';\nimport { ApiService } from './api.service';\nimport { AuthService } from './auth.service';\n\nimport { Election } from '../models/election';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ElectionService {\n\n  constructor(\n    private api: ApiService,\n    private as: AuthService,\n    private gs: GlobalService\n  ) {\n    this.loadElection('active');\n    this.loadMyJoinedElection();\n  }\n\n  loadElection(status = 'all', row = 10) {\n    return this.api.getData(`/election?status=${status}&row=${row}`);\n  }\n\n  loadMyJoinedElection() {\n    return this.api.getData(`/election/my-joined-election`);\n  }\n\n  loadElectionByCreator(electionCreator, status = 'all', row = 10) {\n    return this.api.getData(`/election/?status=${status}&electionCreator=${electionCreator}&row=${row}`);\n  }\n\n  createNewElection(electionData) {\n    return this.api.postData(`/election/create`, electionData);\n  }\n\n  endElectionPeriode(id, data) {\n    return this.api.postData(`/election/${id}/end`, data);\n  }\n\n  getElectionData(id) {\n    return this.api.getData(`/election/${id}`);\n  }\n\n  getElectionCandidate(id) {\n    return this.api.getData(`/election/${id}/candidate`);\n  }\n\n  getElectionParticipant(id) {\n    return this.api.getData(`/election/${id}/participant`);\n  }\n\n  joinElection(id) {\n    return this.api.postData(`/election/${id}/register`);\n  }\n\n  addParticipant(id, data) {\n    return this.api.postData(`/election/${id}/participant`, data);\n  }\n\n  voteCandidate(id, data) {\n    return this.api.postData(`/election/${id}/vote`, data);\n  }\n\n  myVote(id, data) {\n    return this.api.postData(`/election/${id}/my-vote`, data);\n  }\n\n}\n"],"sourceRoot":"webpack:///"}